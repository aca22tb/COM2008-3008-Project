package com.mycompany.loginapp;

import javax.swing.*;
import java.awt.*;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class Customer extends JFrame {

    private JComboBox<String> productComboBox;
    private JTextField quantityField;
    private JButton addToCartButton, viewCartButton;
    private Map<String, Integer> shoppingCart;

    public Customer() {
        setTitle("Customer Page");
        setSize(600, 200);
        setDefaultCloseOperation(EXIT_ON_CLOSE);

        // 初始化组件
        productComboBox = new JComboBox<>();
        quantityField = new JTextField(10);
        addToCartButton = new JButton("Add to Cart");
        viewCartButton = new JButton("View Cart");

        // 添加按钮监听器
        addToCartButton.addActionListener(e -> addToCart());
        viewCartButton.addActionListener(e -> viewCart());

        // 初始化购物车
        shoppingCart = new HashMap<>();

        // 显示可用产品
        displayAvailableProducts();

        // 布局设置
        JPanel panel = new JPanel(new FlowLayout());
        panel.add(new JLabel("Product:"));
        panel.add(productComboBox);
        panel.add(new JLabel("Quantity:"));
        panel.add(quantityField);
        panel.add(addToCartButton);
        panel.add(viewCartButton);

        setLayout(new BorderLayout());
        add(panel, BorderLayout.CENTER);

        setVisible(true);
    }

    // 显示可用产品
    private void displayAvailableProducts() {
        List<String> availableProducts = Product.getAvailableProducts();
        for (String product : availableProducts) {
            productComboBox.addItem(product);
        }
    }

    // 将产品添加到购物车
    private void addToCart() {
        String product = (String) productComboBox.getSelectedItem();
        int quantity = getQuantityFromField();

        if (quantity > 0) {
            shoppingCart.put(product, quantity);
            JOptionPane.showMessageDialog(this, "Product added to cart!");
        } else {
            JOptionPane.showMessageDialog(this, "Invalid quantity. Please enter a valid quantity.");
        }
    }

    // 查看购物车
    private void viewCart() {
        new Cart(shoppingCart);
    }

    // 从数量字段获取数量
    private int getQuantityFromField() {
        try {
            return Integer.parseInt(quantityField.getText());
        } catch (NumberFormatException e) {
            return 0;
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(() -> new Customer());
    }
}
